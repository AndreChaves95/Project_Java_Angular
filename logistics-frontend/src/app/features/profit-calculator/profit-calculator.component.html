<div class="d-flex vh-100">
  <main class="flex-grow-1 bg-light p-4 overflow-auto">
    <mat-card class="p-4">
      <h4 class="fw-bold mb-3">Shipment Profit Calculation</h4>
      <mat-divider class="mb-4"></mat-divider>

      <form [formGroup]="form" (ngSubmit)="calculate()" class="d-flex flex-wrap justify-content-between align-items-end">
        <div class="me-3">
          <h5 class="fw-semibold">Shipment ID</h5>
          <mat-form-field appearance="fill" class="w-100" style="min-width: 100px;">
            <mat-label>ID</mat-label>
            <input matInput type="text" formControlName="shipmentId" />
          </mat-form-field>
        </div>

        <div class="d-flex justify-content-between w-100 mt-3">
          <!-- Income -->
          <div style="width: 40%;">
            <h5 class="fw-semibold mb-1">Income & Outcome</h5>
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Income</mat-label>
              <input matInput type="number" formControlName="income" />
            </mat-form-field>
          </div>

          <!-- Costs -->
          <div style="width: 40%;">
            <h5 class="fw-semibold mb-1">Costs</h5>
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Cost</mat-label>
              <input matInput type="number" formControlName="cost" />
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-100 mt-2">
              <mat-label>Additional Cost</mat-label>
              <input matInput type="number" formControlName="additionalCost" />
            </mat-form-field>
          </div>

          <div class="align-self-end ms-3">
            <button mat-raised-button color="primary" type="submit" [disabled]="!canCalculate()">
              {{ 'Calculate' }}
            </button>
          </div>
        </div>
      </form>
    </mat-card>

    <!-- Results Display Section -->
    <mat-card *ngIf="results.length > 0" class="p-4 mt-3">
      <h4 class="fw-bold mb-3">Calculation Results</h4>
      <mat-divider class="mb-4"></mat-divider>

      <div class="table-container">
        <table mat-table [dataSource]="results" class="mat-elevation-2 w-100">
          <!-- Shipment ID Column -->
          <ng-container matColumnDef="shipmentId">
            <th mat-header-cell *matHeaderCellDef class="fw-bold"> Shipment ID </th>
            <td mat-cell *matCellDef="let result" class="fw-semibold"> {{result.shipmentId}} </td>
          </ng-container>

          <!-- Total Income Column -->
          <ng-container matColumnDef="totalIncome">
            <th mat-header-cell *matHeaderCellDef class="fw-bold"> Total Income </th>
            <td mat-cell *matCellDef="let result" class="text-success fw-bold"> {{result.totalIncome}} </td>
          </ng-container>

          <!-- Total Cost Column -->
          <ng-container matColumnDef="totalCost">
            <th mat-header-cell *matHeaderCellDef class="fw-bold"> Total Costs </th>
            <td mat-cell *matCellDef="let result" class="text-danger fw-bold"> {{result.totalCost}} </td>
          </ng-container>

          <!-- Profit/Loss Column -->
          <ng-container matColumnDef="profitValue">
            <th mat-header-cell *matHeaderCellDef class="fw-bold"> Profit/Loss </th>
            <td mat-cell *matCellDef="let result" class="fw-bold" [ngClass]="result.profitValue >= 0 ? 'text-success' : 'text-danger'">
              {{result.profitValue}}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
    </mat-card>

    <div *ngIf="error" class="alert alert-danger mt-3">{{ error }}</div>
  </main>
</div>
